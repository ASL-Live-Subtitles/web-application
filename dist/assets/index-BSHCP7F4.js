(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const m="https://composite1-592550011076.us-central1.run.app";function f(){const n=localStorage.getItem("auth_token");return n?{Authorization:`Bearer ${n}`}:{}}async function E(n){const e=await fetch(`${m}/asl-pipeline`,{method:"POST",headers:{"Content-Type":"application/json",...f()},body:JSON.stringify(n)});if(!e.ok)throw new Error(`HTTP ${e.status}: ${await e.text()}`);return e.json()}async function B(){const n=await fetch(`${m}/users`,{headers:f()});return n.ok?n.json():null}function S(){window.location.href=`${m}/login`}function b(){localStorage.removeItem("auth_token"),window.location.reload()}function y(n){return n.split(",").map(e=>e.trim()).filter(e=>e.length>0)}document.addEventListener("DOMContentLoaded",()=>{const n=new URLSearchParams(window.location.search).get("token");n&&(localStorage.setItem("auth_token",n),window.history.replaceState({},"",window.location.pathname));const e=document.getElementById("auth-status"),i=document.getElementById("login-link"),r=document.getElementById("logout-link");i.onclick=s=>{s.preventDefault(),S()},r.onclick=s=>{s.preventDefault(),b()};async function t(){try{const s=await B();if(!s){e.textContent="Not signed in",i.style.display="inline",r.style.display="none";return}const a=s.user;e.textContent=`Signed in as ${a.name||a.email}`,i.style.display="none",r.style.display="inline"}catch{e.textContent="Auth error"}}t();const o=document.getElementById("asl-form"),l=document.getElementById("glosses-input"),g=document.getElementById("letters-input"),h=document.getElementById("context-input"),d=document.getElementById("error"),p=document.getElementById("result"),w=document.getElementById("sentence"),I=document.getElementById("sentiment"),c=document.getElementById("submit-button");o.addEventListener("submit",async s=>{s.preventDefault(),d.style.display="none",p.style.display="none";const a={glosses:y(l.value),letters:y(g.value),context:h.value.trim()};c.disabled=!0,c.textContent="Processing...";try{const u=await E(a);w.textContent=u.sentence,I.textContent=u.sentiment.sentiment,p.style.display="block"}catch(u){d.textContent=u.message||"Unknown error",d.style.display="block"}finally{c.disabled=!1,c.textContent="Submit"}})});
